<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>åŠŸè¿‡æ ¼ - åŠŸå¾·ç¢‘</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/animations.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&family=Noto+Serif+JP:wght@200;300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* å›ºå®šå¯¼èˆªæ  - è¦†ç›–components.cssä¸­çš„position: relative */
      .nav-header {
        position: sticky !important;
        top: 0 !important;
        z-index: 100 !important;
        background: var(--color-bg) !important;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border-bottom: 1px solid var(--color-border-light);
        margin-bottom: 0;
        width: 100%;
        /* ä¿æŒåŸæœ‰çš„flexå¸ƒå±€ */
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
      }

      /* ç¡®ä¿é¡µé¢å¯ä»¥æ»šåŠ¨ */
      body {
        overflow-x: hidden;
        overflow-y: auto;
        min-height: 100vh;
      }

      /* ç¡®ä¿å¤–å±‚å®¹å™¨ä¸ä¼šé˜»æ­¢æ»šåŠ¨ */
      body > div[style*="position: relative"] {
        min-height: 100vh;
      }

      .monument-area {
        padding: 20px 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 2;
      }

      .monument-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .header-quote {
        font-size: 16px;
        color: var(--color-text);
        letter-spacing: 4px;
        font-weight: 500;
        opacity: 0.7;
      }

      body.theme-en .header-quote {
        letter-spacing: 1px;
        font-size: 14px;
      }

      .header-line {
        width: 100px;
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--color-border),
          transparent
        );
        margin: 16px auto;
      }

      .monument {
        width: 280px;
        background: linear-gradient(180deg, #f5f2ec 0%, #ebe8e2 100%);
        border-radius: 8px 8px 4px 4px;
        padding: 30px 20px;
        box-shadow: 0 8px 32px var(--color-shadow-dark),
          inset 0 1px 0 rgba(255, 255, 255, 0.5),
          inset 0 -1px 0 rgba(0, 0, 0, 0.05);
        position: relative;
      }

      body.theme-ja .monument {
        background: linear-gradient(180deg, #f7f7f5 0%, #efefe9 100%);
      }

      body.theme-en .monument {
        background: linear-gradient(180deg, #ffffff 0%, #f8fafe 100%);
        border-radius: var(--radius-lg);
      }

      .monument::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");
        border-radius: inherit;
        pointer-events: none;
      }

      body.theme-en .monument::before {
        display: none;
      }

      .dual-columns {
        display: flex;
        justify-content: space-between;
        gap: 30px;
      }

      .column {
        flex: 1;
        text-align: center;
      }

      .column-title {
        font-size: 14px;
        font-weight: 600;
        letter-spacing: 4px;
        margin-bottom: 20px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--color-border-light);
      }

      body.theme-en .column-title {
        letter-spacing: 1px;
      }

      .column-title.gong {
        color: var(--color-gong);
      }

      .column-title.guo {
        color: var(--color-guo);
      }

      .column-value {
        font-size: 15px;
        line-height: 2.2;
        height: 280px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
      }

      /* ä¸­æ–‡ä¸»é¢˜ç«–æ’ */
      body.theme-zh .column-value {
        writing-mode: vertical-rl;
        text-orientation: upright;
      }

      /* æ—¥æ–‡å’Œè‹±æ–‡ä¸»é¢˜ä¿æŒæ¨ªæ’ */
      body.theme-ja .column-value,
      body.theme-en .column-value {
        writing-mode: horizontal-tb;
        text-orientation: mixed;
      }

      .column-value.gong {
        color: var(--color-gong);
      }

      .column-value.guo {
        color: var(--color-guo);
        opacity: 0.8;
      }

      .value-main {
        font-size: 33px;
        letter-spacing: 2px;
        font-weight: 500;
        line-height: 1.3;
      }

      /* æ—¥æ–‡ä¸»é¢˜æ•°å­—æ ·å¼ */
      body.theme-ja .value-main {
        font-size: 32px;
        letter-spacing: 1px;
        font-weight: 500;
      }

      body.theme-en .value-main {
        font-size: 24px;
        font-weight: 700;
        letter-spacing: 0;
      }

      .value-unit {
        font-size: 10px;
        opacity: 0.6;
        margin-top: 4px;
        line-height: 1.6;
        max-width: 100%;
        text-align: center;
      }

      /* ä¸­æ–‡ä¸»é¢˜ç«–æ’æ—¶çš„é—´è· */
      body.theme-zh .value-unit {
        margin-top: 8px;
        writing-mode: vertical-rl;
        text-orientation: upright;
      }

      /* æ—¥æ–‡ä¸»é¢˜æ¨ªæ’æ—¶çš„é—´è·å’Œæ ·å¼ä¼˜åŒ– */
      body.theme-ja .value-unit {
        font-size: 11px;
        margin-top: 16px;
        line-height: 1.8;
        opacity: 0.65;
        padding: 0 8px;
        max-width: 90%;
      }

      body.theme-en .value-unit {
        font-size: 12px;
        margin-top: 12px;
        line-height: 1.7;
        opacity: 0.7;
        padding: 0 10px;
        max-width: 95%;
      }

      .monument-footer {
        text-align: center;
        margin-top: 30px;
        padding: 0 20px;
      }

      .footer-text {
        font-size: 11px;
        color: var(--color-text);
        opacity: 0.3;
        letter-spacing: 1px;
        line-height: 2;
      }

      .start-date {
        text-align: center;
        margin-top: 40px;
        position: relative;
        z-index: 2;
      }

      .start-label {
        font-size: 11px;
        color: var(--color-text);
        opacity: 0.3;
        letter-spacing: 2px;
      }

      .start-value {
        font-size: 13px;
        color: var(--color-text);
        opacity: 0.5;
        margin-top: 6px;
        letter-spacing: 1px;
      }

      /* ç™»å½•æç¤º */
      .login-prompt {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--color-bg);
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 10;
        padding: 40px;
        text-align: center;
      }

      .login-prompt.show {
        display: flex;
      }

      .login-icon {
        font-size: 48px;
        margin-bottom: 20px;
        opacity: 0.5;
      }

      .login-message {
        font-size: 14px;
        color: var(--color-text);
        opacity: 0.6;
        margin-bottom: 24px;
        line-height: 1.8;
      }
      /* è§†è§‰å¾®è°ƒï¼šåŠŸè¿™ä¸€åˆ—åœ¨ä¸­æ–‡ç«–æ’ä¸‹ç•¥å¾®å³ç§» */
      /* ä¸­æ–‡ç«–æ’ï¼šå·¦å³ä¸¤åˆ—ç»Ÿä¸€è§†è§‰å³ç§» */
      body.theme-zh .column-value.gong,
      body.theme-zh .column-value.guo {
        transform: translateX(20px);
      }
    </style>
  </head>

  <body class="theme-zh">
    <div style="position: relative">
      <div class="nav-header">
        <div class="back-btn" id="backBtn">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M15 18l-6-6 6-6" />
          </svg>
        </div>
        <div class="nav-title" data-i18n="monument.title">åŠŸå¾·ç¢‘</div>
        <div class="nav-right"></div>
      </div>

      <div class="monument-area" id="monumentContent">
        <div class="monument-header">
          <div class="header-quote" data-i18n="monument.quote">
            ä»å‰ç§ç§ã€€è­¬å¦‚æ˜¨æ—¥æ­»
          </div>
          <div class="header-line"></div>
        </div>

        <div class="monument">
          <div class="dual-columns">
            <div class="column">
              <div class="column-title gong" data-i18n="monument.totalGong">
                ç´¯è®¡åŠŸ
              </div>
              <div class="column-value gong">
                <span class="value-main" id="gongValue"
                  >ä¸€ä¸‡äºŒåƒå…«ä¸‡äºŒåƒä¸‡äºŒåƒç™¾å››åä¸ƒ</span
                >
                <span class="value-unit" data-i18n="monument.gongUnit"
                  >åˆ©ç›Šä»–äººã€æœ‰ç›Šäºä¸–çš„å–„è¡Œï¼Œå³ä½¿å¾®å°äº¦èƒ½ç§¯ç´¯ç¦å¾·ã€‚</span
                >
              </div>
            </div>

            <div class="column">
              <div class="column-title guo" data-i18n="monument.totalGuo">
                ç´¯è®¡è¿‡
              </div>
              <div class="column-value guo">
                <span class="value-main" id="guoValue">ä¸‰ç™¾äºŒåä¸ƒ</span>
                <span class="value-unit" data-i18n="monument.guoUnit"
                  >æŸäººåˆ©å·±ã€è¿èƒŒå¤©ç†çš„æ¶è¡Œï¼Œå³ä½¿æ— å¿ƒä¹Ÿéœ€å¿æ‚”æ¶ˆè§£ã€‚</span
                >
              </div>
            </div>
          </div>
        </div>

        <div class="monument-footer">
          <div class="footer-text">
            <span data-i18n="monument.footer1">ç»ˆèº«åŠŸè¿‡ã€€å¹¶åˆ—è€Œè¡Œ</span><br />
            <span data-i18n="monument.footer2">å”¯æ„¿è¿‡æ ã€€æ—¥æ¸ç¨€ç–</span>
          </div>
        </div>
      </div>

      <div class="start-date">
        <div class="start-label" data-i18n="monument.startDate">ç«‹ç¢‘ä¹‹æ—¥</div>
        <div class="start-value" id="startDate">
          ä¹™å·³å¹´ æ­£æœˆåˆä¸€ Â· 2025å¹´1æœˆ29æ—¥
        </div>
      </div>

      <!-- ç™»å½•æç¤ºå±‚ -->
      <div class="login-prompt" id="loginPrompt">
        <div class="login-icon">ğŸ›ï¸</div>
        <div class="login-message" data-i18n="monument.loginRequired">
          è¯·ç™»å½•åæŸ¥çœ‹ä½ çš„åŠŸå¾·ç¢‘
        </div>
        <button
          class="btn btn-primary"
          data-action="login"
          data-i18n="monument.goLogin"
        >
          å‰å¾€ç™»å½•
        </button>
      </div>
    </div>

    <script src="js/i18n.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/store.js"></script>
    <script src="js/modals.js"></script>
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var t = window.i18n
          ? window.i18n.t
          : function (k) {
              return k;
            };
        var toNum = window.i18n
          ? window.i18n.toLocalNumber
          : function (n) {
              return n;
            };

        // è¿”å›
        document
          .getElementById("backBtn")
          .addEventListener("click", function () {
            window.location.href = "home.html";
          });

        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        var isLoggedIn = window.store ? window.store.isLoggedIn() : false;
        var loginPrompt = document.getElementById("loginPrompt");

        // æš‚æ—¶ä¸æ£€æŸ¥ç™»å½•ï¼Œç›´æ¥æ˜¾ç¤ºæ•°æ®
        // if (!isLoggedIn) {
        //   loginPrompt.classList.add('show');
        //   loginPrompt.querySelector('[data-action="login"]').addEventListener('click', function() {
        //     window.modals.showLoginModal({
        //       onSuccess: function() {
        //         loginPrompt.classList.remove('show');
        //         loadMonumentData();
        //       }
        //     });
        //   });
        //   return;
        // }

        // ä½¿ç”¨ç«‹å³æ‰§è¡Œçš„å¼‚æ­¥å‡½æ•°æ¥åŠ è½½æ•°æ®
        (async function () {
          await loadMonumentData();
        })();

        async function loadMonumentData() {
          if (window.store && window.store.getTotalStats) {
            try {
              var stats = await window.store.getTotalStats();
              // ç¡®ä¿ stats å­˜åœ¨ä¸”æœ‰æœ‰æ•ˆå€¼
              var gong =
                stats && typeof stats.gong === "number" ? stats.gong : 0;
              var guo = stats && typeof stats.guo === "number" ? stats.guo : 0;

              document.getElementById("gongValue").textContent = toNum(gong);
              document.getElementById("guoValue").textContent = toNum(guo);
            } catch (error) {
              console.error("åŠ è½½åŠŸå¾·ç¢‘æ•°æ®å¤±è´¥:", error);
              // æ˜¾ç¤ºé»˜è®¤å€¼
              document.getElementById("gongValue").textContent = toNum(0);
              document.getElementById("guoValue").textContent = toNum(0);
            }
          } else {
            // å¦‚æœæ²¡æœ‰ storeï¼Œæ˜¾ç¤ºé»˜è®¤å€¼
            document.getElementById("gongValue").textContent = toNum(0);
            document.getElementById("guoValue").textContent = toNum(0);
          }
        }
      });
    </script>
  </body>
</html>
